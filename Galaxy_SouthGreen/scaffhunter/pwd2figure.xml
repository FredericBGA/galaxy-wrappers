<tool id="pwd2figure" name="pwd2figure" version="0.1"> 
    <description> : Convert JoinMap pair-wise file to figure and create .dis and .don files for DARwin</description>  
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <command>
		source $__tool_directory__/include_scaffhunter.sh ;
        python $__tool_directory__/pwd2figure.py  
		--pwd $joinmap
		--order $order
		--type $type
		--png $png_file
		--dis $dis_file
		--don $don_file
    </command>
    <inputs>  
    	<param name="joinmap" type="data" format="tabular" label="JoinMap pair-wise file" />
    	<param name="order" type="data" format="tabular" label="Tabulated file containing in col1 : markers names and col2 : chromosome name. Marker should be grouped by chromosome and ordered by their position on chromosome" />
		<param name="type" type="select" label="The type of data to use LOD or REC" >
			<option value="LOD" selected="true">LOD</option>
			<option value="REC">REC</option>
		</param>
		<param name="prefix" type="text" label="Prefix of output files" value="Darwin" />
    </inputs>
    <outputs>
        <data format="png" name="png_file" label="${tool.name} : $prefix .png" />
        <data format="txt" name="dis_file" label="${tool.name} : $prefix .dis" />
        <data format="txt" name="don_file" label="${tool.name} : $prefix .don" />
    </outputs>
    <tests>
        <test>
            <param name="joinmap" value="pairwise.pwd"/>
            <param name="order" value="alignment_chromosome.txt" /> 
            <param name="type" value="LOD" /> 
            <output name="png_file" file="pwd2figure.png" compare="sim_size"/>
            <output name="dis_file" file="dis_file.txt" compare="sim_size"/>
            <output name="don_file" file="don_file.txt" compare="sim_size"/>
        </test>
    </tests> 
    <help>
    
**Overview**

This program take a pairwise file generated by JoinMap and return a dot-plot representing pairwise marker linkage of markers along chromosomes.

Two additional file are generated that can be used by Darwin_ software to construct tree.

These files contain pairwise recombination rate converted into mapping distance using the Kosambi mapping function.

.. _Darwin: http://darwin.cirad.fr/


Example : Linkage between markers.
A. Markers linkage between markers ordered along the newly assembled chromosome.

B. Tree representing marker linkage built using Darwin_ software.

.. image:: http://orygenesdb.cirad.fr/images/linkage_marker2.png


-----

.. class:: infomark

**Galaxy integration** Martin Guillaume (CIRAD), Droc Gaetan (CIRAD).

.. class:: infomark

**Support** For any questions about Galaxy integration, please send an e-mail to galaxy-dev-southgreen@cirad.fr

.. class:: infomark

**Program encapsulated in Galaxy by South Green**

	</help>
	<citations>
        <citation type="doi">10.1186/s12864-016-2579-4</citation> 
    </citations>
</tool>  