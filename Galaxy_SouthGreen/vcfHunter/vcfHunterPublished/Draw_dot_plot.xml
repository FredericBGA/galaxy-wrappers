<tool id="Draw_dot_plot" name="Draw_dot_plot" version="0.1.0">
    <requirements>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <command><![CDATA[
          source $__tool_directory__/module_python3.sh;
          
          #if str($locus.selectloc) == "no":
            cut -f 1 $locus.loc | grep -v Marker > toto1;
            cut -f 1 $locus.loc | grep -v Marker | sed 's/M/\t'/ > toto2;
            paste toto1 toto2 > MarkerOrder.tab;
            rm toto1 toto2;
          #end if
          
          python3 $__tool_directory__/Draw_dot_plot.py
            --matrix $matrix
            #if str($locus.selectloc) == "yes":
                --loc $locus.loc
            #else if str($locus.selectloc) == "no":
                --loc MarkerOrder.tab
            #end if
            #if str($chr):
                --chr $chr
            #end if
            #if str($agp) != "None":
                --agp $agp
            #end if
            #if str($stat) != "None":
                --stat $stat
            #end if
            --phys $phys
            --output out.png;
            cp -rf out.png $out;
            cp -rf out_heatmap.png $heatmap;
            #if str($locus.selectloc) == "no":
                rm MarkerOrder.tab;
            #end if
    ]]></command>
    <inputs>
        <param name="matrix" type= "data" format="tabular" label="The pairwise matrix marker file" help="generated by RecombCalculatorDDose (REC.tab)"/>
        <conditional name="locus">
            <param name = "selectloc" label="I already have a locus file" type = "select" help="col1: marker name, col2: chromosome, col3: position">
                <option value="yes">yes</option>
                <option value="no">no</option>
            </param>
            <when value="yes">
                 <param name="loc" type= "data" format="tabular" label="Loci to plot with their locations" help="col1: marker name, col2: chromosome, col3: position"/>
            </when>
             <when value="no">
                <param name="loc" type= "data" format="tabular" label="Pop_tab_SegregationName_Parent.tab from vcf2popNew" help="create your locus file"/>
             </when>
        </conditional>
        <param name="chr" type= "text" label="List of chromosomes to draw in this order" help="separated by ':'. If not filled, all chromosomes are used." optional="true"/>
        <param name="agp" type= "data" format="tabular" label="Agp file locating scaffolds in the reference sequence" optional="true"/>
        <param name="stat" type= "data" format="tabular" label="stats" help="A two column file with column 1: marker name, column2: statistics (SegDist.tab)" optional="true"/>
        <param name="phys" type= "select" label="A value specifying if the marker position should be defined based on physical position or not">
            <option value="y">y</option>
            <option value="n">n</option>
        </param>
    </inputs>
    <outputs>
        <data format="png" label="output.png" name="out"/>
        <data format="png" label="output_heatmap.png" name="heatmap"/>
    </outputs>
    <help><![CDATA[
                   
.. class:: infomark

**Author**     Guillaume MARTIN (guillaume.martin@cirad.fr)

.. class:: infomark

**Galaxy integration** Aurore Comte

.. class:: infomark

**Support** For any questions about Galaxy integration, please send an e-mail to aurore.comte@ird.fr

---------------------------------------------------

=============
Draw_dot_plot
=============

-----------
Description
-----------

This program draw a dotplot based on marker pairwise recombination file obtained from RecombCalculatorDDose.  

--------
Inpputs:
--------

The pairwise matrix marker file = REC.tab from RecombCalculatorDDose

Stats = SegDist.tab from RecombCalculatorDDose

--------
Outputs:
--------

A dotplot file representing pairwise marker linkage

A heatmap file representing pairwise statistic coding

----------------------
For more informations:
----------------------

https://github.com/SouthGreenPlatform/VcfHunter


    ]]></help>
    <citations>
        <citation type="doi">10.1093/molbev/msy199</citation>
    </citations>
</tool>